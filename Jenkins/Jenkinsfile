pipeline {
  agent any
    stages {
        stage('SCM Checkout'){
          steps {
            git 'https://github.com/F3rnand3s/jenkins-test'
          }
        }
        
        agent {
          docker { image 'node:7-alpine' }
          }
            stages {
                stage('Test') {
                    steps {
                        sh 'node --version'
                    }
                }
            }
            
        stage('Build APP') {
          steps {
            echo 'Welcome to the Build APP Stage!'
            sh 'pwd'
            sh 'ls -la '
            sh 'docker build -t app:jenkins ./app'
            sh 'docker rmi app:jenkins'
          }
        }

        stage('Build nginx image') {
          steps {
            echo 'Welcome to the Build nginx Stage!'
            sh 'pwd'
            sh 'docker build -t nginx:jenkins ./nginx'
            sh 'docker rmi nginx:jenkins'
          }
        }

        stage('Testing') {
          steps {
            echo 'Welcome to the Testing Stage!'
          }
        }

        stage('Cleanup') {
          steps {
            echo 'Welcome to the Cleanup Stage!'
            sh 'ls -la'
            sh 'rm -rf *'
            sh 'ls -la'
          }
        }
    }
}

